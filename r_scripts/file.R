library(magrittr) # needs to be run every time you start R and want to use %>%
library(dplyr)    # alternatively, this also loads %>%
library(tidyverse)
library(ggpubr)
library(rstatix)

#THIS IS THE PART OF CODE THAT WE NEED

#let's repeat it with our data - out of 5 folds

id = 1:120 # we have 160 scores in total
entries = 20
model = c(rep("KNeighbors", entries), rep("MPNN", entries), rep("LogRegress", entries), rep("RandForest", entries), rep("XGBoost", entries), rep("RbfSvm", entries))
knScores = c(0.8644184445973847, 0.8506363027461487, 0.8565656565656566, 0.8728755948334467, 0.8732970027247956, 0.8457300275482094, 0.8631436314363143, 0.8748317631224765, 0.8418891170431211, 0.8640973630831643, 0.854631507775524, 0.8544726301735648, 0.8598256203890007, 0.8679245283018868, 0.8571428571428572, 0.8619756427604872, 0.859069453809845, 0.8654104979811574, 0.8671140939597316, 0.8654496281271129)
mpnnScores = c(0.9329488103821196, 0.9210716871832005, 0.944081336238199, 0.9315673289183224, 0.9325598259608411, 0.9370021723388848, 0.9297610427226647, 0.9314079422382672, 0.9344852411807055, 0.9287790697674418, 0.9301310043668122, 0.9293948126801151, 0.9327548806941431, 0.9286754002911207, 0.9308084486525855, 0.9341057204923968, 0.9328571428571429, 0.9428778018799711, 0.9326574945691528, 0.9159970781592404)
lrScores = c(0.9042769857433808, 0.8932698844323591, 0.9040540540540539, 0.9062499999999999, 0.8960863697705803, 0.9110957960027567, 0.9023066485753053, 0.9008042895442359, 0.8942436412315931, 0.901023890784983, 0.9082256968048946, 0.8873904248145651, 0.9018280297901151, 0.9073569482288828, 0.9053055742108798, 0.9130434782608696, 0.900473933649289, 0.9076086956521738, 0.8926174496644296, 0.896969696969697)
rfScores = c(0.9534206695778749, 0.9522409992652462, 0.9444043321299639, 0.942461762563729, 0.9489575844716033, 0.9538239538239538, 0.9499263622974963, 0.9429602888086642, 0.9587852494577006, 0.955137481910275, 0.944927536231884, 0.9501466275659824, 0.950509461426492, 0.9394812680115273, 0.9438366156090445, 0.942209217264082, 0.9546436285097192, 0.9532710280373833, 0.9451659451659452, 0.946298984034833)
xgbScores = c(0.9490084985835693, 0.9472182596291013, 0.9653679653679654, 0.9514285714285714, 0.9477401129943503, 0.9508896797153026, 0.9575671852899575, 0.9470672389127324, 0.9530685920577617, 0.9474431818181818, 0.9547088425593099, 0.9527836504580691, 0.9618979151689433, 0.9503239740820734, 0.952991452991453, 0.9479686386315039, 0.9433427762039659, 0.9547738693467337, 0.9476702508960574, 0.9639769452449567)
rbfSvm = c(0.7168234064785789, 0.7125, 0.7112493519958527, 0.697508896797153, 0.696800406297613, 0.7213459516298634, 0.7017902813299233, 0.7014848950332822, 0.7036466358500256, 0.7079463364293086, 0.7190775681341719, 0.7028688524590163, 0.700715015321757, 0.7040082219938335, 0.7072164948453609, 0.7137662337662337, 0.7083764219234747, 0.7028688524590163, 0.7072792978833247, 0.7021494370522006)

scores = c(knScores, mpnnScores, lrScores, rfScores, xgbScores, rbfSvm)
model
scores

results = data.frame(id, model, scores)
#final model
results

# Pairwise comparisons
pwc <- results %>%
  pairwise_t_test(
    scores ~ model, paired = TRUE,
    p.adjust.method = "bonferroni"
  )
pwc


# Visualization: box plots with p-values
pwc <- pwc %>% add_xy_position(x = "models")
ggboxplot(results, x = "model", y = "scores", add = "point") +
  stat_pvalue_manual(pwc)
