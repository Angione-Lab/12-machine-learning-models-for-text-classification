library(magrittr) # needs to be run every time you start R and want to use %>%

library(dplyr)    # alternatively, this also loads %>%

library(tidyverse)

library(ggpubr)

library(rstatix)



runs = 20;

id = 1:(runs*3) # we have 20 scores in total for each model - we are focusing on 3 models in this script

#model = c(rep("mod_1",runs), rep("mod_2",runs), rep("mod_3",runs), rep("mod_4",runs), rep("mod_5",runs), #rep("mod_6",runs))

model = c(rep("MPNN",runs), rep("Random Forest",runs), rep("XGBOOST",runs))

method_1_scores = c(0.8644184445973847,0.8506363027461487,0.8565656565656566,0.8728755948334467,0.8732970027247956,0.8457300275482094,0.8631436314363143,0.8748317631224765,0.8418891170431211,0.8640973630831643,0.854631507775524,0.8544726301735648,0.8598256203890007,0.8679245283018868,0.8571428571428572,0.8619756427604872,0.859069453809845,0.8654104979811574,0.8671140939597316,0.8654496281271129)

method_2_scores = c(0.9329488103821196,0.9210716871832005,0.944081336238199,0.9315673289183224,0.9325598259608411,0.9370021723388848,0.9297610427226647,0.9314079422382672,0.9344852411807055,0.9287790697674418,0.9301310043668122,0.9293948126801151,0.9327548806941431,0.9286754002911207,0.9308084486525855,0.9341057204923968,0.9328571428571429,0.9428778018799711,0.9326574945691528,0.9159970781592404)

method_3_scores = c(0.9042769857433808,0.8932698844323591,0.9040540540540539,0.9062499999999999,0.8960863697705803,0.9110957960027567,0.9023066485753053,0.9008042895442359,0.8942436412315931,0.901023890784983,0.9082256968048946,0.8873904248145651,0.9018280297901151,0.9073569482288828,0.9053055742108798,0.9130434782608696,0.900473933649289,0.9076086956521738,0.8926174496644296,0.896969696969697)


method_4_scores = c(0.9534206695778749,0.9522409992652462,0.9444043321299639,0.942461762563729,0.9489575844716033,0.9538239538239538,0.9499263622974963,0.9429602888086642,0.9587852494577006,0.955137481910275,0.944927536231884,0.9501466275659824,0.950509461426492,0.9394812680115273,0.9438366156090445,0.942209217264082,0.9546436285097192,0.9532710280373833,0.9451659451659452,0.946298984034833)

method_5_scores = c(0.9490084985835693,0.9472182596291013,0.9653679653679654,0.9514285714285714,0.9477401129943503,0.9508896797153026,0.9575671852899575,0.9470672389127324,0.9530685920577617,0.9474431818181818,0.9547088425593099,0.9527836504580691,0.9618979151689433,0.9503239740820734,0.952991452991453,0.9479686386315039,0.9433427762039659,0.9547738693467337,0.9476702508960574,0.9639769452449567)

method_6_scores = c(0.7227513227513228,0.726304579339723,0.7278514588859417,0.7235169491525424,0.7306866952789699,0.7328,0.7334410339256866,0.7215189873417722,0.7258235919234856,0.7213983050847457,0.724960254372019,0.7293112653497063,0.7279489904357067,0.7223691168693812,0.7287319422150883,0.7257294429708224,0.7277570591369206,0.7303790710090763,0.7245604688332444,0.7229551451187336)

#scores = c(method_1_scores[1:runs], method_2_scores[1:runs], method_3_scores[1:runs], method_4_scores[1:runs], method_5_scores[1:runs], method_6_scores[1:runs])

scores = c(method_2_scores[1:runs], method_4_scores[1:runs], method_5_scores[1:runs])

model

scores



results = data.frame(id, model, scores)

#final model

results



# Pairwise comparisons

pwc <- results %>%

  pairwise_t_test(

    scores ~ model, paired = TRUE,

    p.adjust.method = "bonferroni"

    )

pwc





# Visualization: box plots with p-values

pwc <- pwc %>% add_xy_position(x = "models")

ggboxplot(results, x = "model", y = "scores", add = "point") +

  stat_pvalue_manual(pwc)
